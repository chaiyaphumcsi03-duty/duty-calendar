<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>Admin - ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÄ‡∏ß‡∏£</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;600&display=swap" rel="stylesheet">

<style>
body {
  font-family: 'Sarabun', sans-serif;
  background: #f1f3f4;
  padding: 20px;
}

.card {
  max-width: 480px;
  margin: auto;
  background: white;
  padding: 20px;
  border-radius: 10px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}

input, select {
  width: 100%;
  padding: 10px;
  margin-top: 8px;
  margin-bottom: 15px;
  border-radius: 6px;
  border: 1px solid #ccc;
}

button {
  width: 100%;
  padding: 10px;
  background: #1a73e8;
  color: white;
  font-size: 16px;
  border-radius: 8px;
  border: none;
  cursor: pointer;
}

.profile-wrapper {
  display: flex;
  gap: 10px;
  justify-content: space-between;
  margin-bottom: 10px;
}

.profile-box {
  flex: 1;
  text-align: center;
  margin-bottom: 10px;
  padding: 8px;
  border-radius: 8px;
  background: #f5f5f5;
}

.profile-box img {
  width: 70px;
  height: 70px;
  border-radius: 50%;
  object-fit: cover;
  margin-bottom: 5px;
}

.profile-title {
  font-size: 14px;
  font-weight: 600;
}

.profile-name {
  font-size: 14px;
}

.profile-phone {
  font-size: 13px;
}
</style>
</head>
<body>

<div class="card">
  <h2>‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏ß‡∏£</h2>

  <label>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</label>
  <input type="date" id="dutyDate">

  <label>‡πÄ‡∏ß‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏¥‡∏î‡πÄ‡∏´‡∏ï‡∏∏ (CSI)</label>
  <select id="dutyCsi" onchange="showProfile('csi')"></select>

  <label>‡πÄ‡∏ß‡∏£‡∏£‡∏±‡∏ö‡∏Ç‡∏≠‡∏á‡∏Å‡∏•‡∏≤‡∏á‡∏¢‡∏≤‡πÄ‡∏™‡∏û‡∏ï‡∏¥‡∏î (DRUG)</label>
  <select id="dutyDrug" onchange="showProfile('drug')"></select>

  <div class="profile-wrapper">
    <div class="profile-box" id="previewCsi" style="display:none;">
      <div class="profile-title">CSI</div>
      <img id="previewCsiImg">
      <div class="profile-name" id="previewCsiName"></div>
      <div class="profile-phone" id="previewCsiPhone"></div>
    </div>

    <div class="profile-box" id="previewDrug" style="display:none;">
      <div class="profile-title">DRUG</div>
      <img id="previewDrugImg">
      <div class="profile-name" id="previewDrugName"></div>
      <div class="profile-phone" id="previewDrugPhone"></div>
    </div>
  </div>

  <button onclick="updateDuty()">‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>

  <p id="status"></p>
</div>

<script>
// ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡∏∏‡∏Ñ‡∏•‡∏≤‡∏Å‡∏£
const officers = [
  { name: "‡∏û.‡∏ï.‡∏ó.‡∏´‡∏ç‡∏¥‡∏á ‡∏Å‡∏ô‡∏Å‡∏ß‡∏£‡∏£‡∏ì ‡∏≠‡∏¥‡πà‡∏°‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏¥‡πå", phone: "0896496219", photo: "https://i.imgur.com/Cu8Eee5.jpeg", color: "#4285F4" },
  { name: "‡∏û.‡∏ï.‡∏ó.‡πÄ‡∏®‡∏Å‡∏™‡∏£‡∏£‡∏Ñ‡πå ‡∏ò‡∏£‡∏£‡∏°‡∏Å‡∏∏‡∏•",          phone: "0878742006", photo: "https://i.imgur.com/R0WnYbq.jpeg", color: "#34A853" },
  { name: "‡∏£.‡∏ï.‡∏≠.‡∏™‡∏∏‡∏£‡∏û‡∏á‡∏©‡πå ‡∏´‡∏°‡∏≠‡∏î‡∏µ",            phone: "0982685522", photo: "https://i.imgur.com/H53f6Nv.jpeg", color: "#F9AB00" },
  { name: "‡∏£.‡∏ï.‡∏≠.‡∏ò‡∏µ‡∏£‡∏†‡∏±‡∏ó‡∏£ ‡∏†‡∏¥‡∏†‡∏±‡∏ó‡∏£‡∏ï‡∏£‡∏∞‡∏Å‡∏π‡∏•‡∏ß‡∏á‡∏©‡πå", phone: "0994980007", photo: "https://i.imgur.com/MvV4Rqr.jpeg", color: "#EA4335" },
  { name: "‡∏£.‡∏ï.‡∏≠.‡∏≠‡∏ô‡∏∏‡∏ä‡∏≤ ‡∏®‡∏∂‡∏Å‡∏Ç‡∏¢‡∏≤‡∏î",             phone: "0642926026", photo: "https://i.imgur.com/XtqsN9Y.jpeg", color: "#9C27B0" },
  { name: "‡∏£.‡∏ï.‡∏≠.‡∏ô‡∏£‡∏¥‡∏ô‡∏ó‡∏£‡πå ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏ú‡∏•",           phone: "0841561591", photo: "https://i.imgur.com/yBcNwLI.jpeg", color: "#00ACC1" },
  { name: "‡∏£.‡∏ï.‡∏ó.‡πÄ‡∏Å‡∏©‡∏° ‡∏¢‡∏ô‡∏ï‡πå‡∏õ‡∏£‡∏∞‡∏û‡∏±‡∏ô‡∏ò‡πå",         phone: "0925678896", photo: "https://i.imgur.com/ioL2Nev.jpeg", color: "#F4511E" },
  { name: "‡∏£.‡∏ï.‡∏ó.‡∏´‡∏ç‡∏¥‡∏á ‡∏ô‡∏±‡∏ô‡∏ó‡πå‡∏ô‡∏†‡∏±‡∏™ ‡∏û‡∏á‡∏©‡πå‡∏™‡∏∏‡∏ß‡∏£‡∏£‡∏ì‡πå", phone: "0935499258", photo: "https://i.imgur.com/9fUB1wW.jpeg", color: "#8E24AA" }
];

// ‡πÄ‡∏ï‡∏¥‡∏° dropdown ‡∏ó‡∏±‡πâ‡∏á‡∏™‡∏≠‡∏á‡∏≠‡∏±‡∏ô
const selCsi  = document.getElementById("dutyCsi");
const selDrug = document.getElementById("dutyDrug");

officers.forEach(o => {
  selCsi.innerHTML  += `<option value="${o.name}">${o.name}</option>`;
  selDrug.innerHTML += `<option value="${o.name}">${o.name}</option>`;
});

function showProfile(type) {
  if (type === 'csi') {
    const selected = officers.find(o => o.name === selCsi.value);
    if (!selected) return;
    document.getElementById("previewCsi").style.display = "block";
    document.getElementById("previewCsiImg").src   = selected.photo;
    document.getElementById("previewCsiName").innerText  = selected.name;
    document.getElementById("previewCsiPhone").innerText = "üìû " + selected.phone;
  } else if (type === 'drug') {
    const selected = officers.find(o => o.name === selDrug.value);
    if (!selected) return;
    document.getElementById("previewDrug").style.display = "block";
    document.getElementById("previewDrugImg").src   = selected.photo;
    document.getElementById("previewDrugName").innerText  = selected.name;
    document.getElementById("previewDrugPhone").innerText = "üìû " + selected.phone;
  }
}

// ‡πÉ‡∏™‡πà URL Apps Script ‡∏ï‡∏±‡∏ß‡πÉ‡∏´‡∏°‡πà‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ (‡∏≠‡∏¢‡πà‡∏≤‡πÉ‡∏™‡πà ?update=1 ‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ)
const apiUpdateURL = "https://script.google.com/macros/s/AKfycby6aCYPZ6Hv7EuSbdp-ODw_CSUw30qK2y8jfeWdb0bMgeXtzYBhuPIKUEYsCnyggCDk/exec";

function updateDuty() {
  const date = document.getElementById("dutyDate").value;
  const csiName  = selCsi.value;
  const drugName = selDrug.value;

  if (!date) {
    alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà");
    return;
  }

  const url = apiUpdateURL
    + "?update=1"
    + "&date=" + encodeURIComponent(date)
    + "&csi="  + encodeURIComponent(csiName)
    + "&drug=" + encodeURIComponent(drugName);

  fetch(url)
    .then(res => res.text())
    .then(() => {
      document.getElementById("status").innerHTML =
        "<b style='color:green;'>‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!</b>";
    })
    .catch(err => {
      document.getElementById("status").innerHTML =
        "<b style='color:red;'>‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</b>";
      console.error(err);
    });
}
</script>

</body>
</html>
